!function(e,t){"use strict";var i,s,o,n,a,l,r=document.title,d={x:10,y:10},c={x:0,y:0},m=document.createElement("div"),u="-新消息提醒  ",p=0,y=function(e){var t;if(e){for(var i=document.scripts,s=0,o=i.length;o>s;s++)if(i[s].src&&0<i[s].src.indexOf(e)){t=i[s].src;break}}else t=location.href;var n={};if(!t)return{str:"",json:n,domain:""};var a,l=t.indexOf("?"),r=t.indexOf("//")>-1?t.indexOf("//"):0,d=t.slice(r,t.indexOf("/",r+2)),c=t.slice(l+1).split("&");n.src=t.slice(0,l);for(var m=0,u=c.length;u>m;m++)a=c[m].split("="),n[a[0]]=a.length>1?a[1]:"";return{str:t,json:n,domain:d+"/"}},h=y("easemob.js");h.json.hide="false"===h.json.hide?!1:h.json.hide;var f=function(){i.listenToIframe(function(e){var t,i,o,n="新消息提醒";if(e.indexOf("setuser")>-1&&(t=e.split("@").length>0?e.split("@")[1]:"",e=e.split("@").length>0?e.split("@")[0]:""),e.indexOf("notify")>-1&&(n=e.slice(6),e="notify"),e.indexOf("dragready")>-1){var a=e.slice(9);c.x=isNaN(Number(a.split("&")[0]))?0:Number(a.split("&")[0]),c.y=isNaN(Number(a.split("&")[1]))?0:Number(a.split("&")[1]),e="dragready"}if(e.indexOf("setchannel")>-1&&(i=e.split("@").length>0?e.split("@")[1]:"",e=e.split("@").length>0?e.split("@")[0]:""),e.indexOf("setgroupuser")>-1){var l=e.indexOf("@emgroupuser@");t=e.slice(13,l),o=unescape(e.slice(l+13)),e="setgroupuser"}switch(e){case"msgPrompt":var y,f=(r+u).split("");clearInterval(p),p=setInterval(function(){y=f.shift(),document.title=y+Array.prototype.join.call(f,""),f.push(y)},360);break;case"notify":j(h.domain+"webim/static/img/notify.png","新消息",n);break;case"recoveryTitle":clearInterval(p),document.title=r;break;case"showChat":s.style.width="400px",s.style.height="500px",s.style.right=d.x+"px",s.style.bottom=d.y+"px",s.style.cssText+="box-shadow: 0 4px 8px rgba(0,0,0,.2);border-radius: 4px;border: 1px solid #ccc\\9;";break;case"minChat":v&&clearTimeout(v),s.style.boxShadow="none",s.style.borderRadius="4px;",s.style.left="auto",s.style.right="-5px",s.style.top="auto",s.style.bottom="10px",s.style.border="none",h.json.hide?(s.style.width="12px",s.style.height="12px"):(s.style.height="37px",s.style.width="104px");break;case"setuser":Emc.setcookie("emKefuUser",t);break;case"setgroupuser":Emc.setcookie(o,t);break;case"setchannel":Emc.setcookie("emKefuChannel",i);break;case"dragready":m.style.display="block",s.style.display="none",EasemobWidget.utils.on(document,"mousemove",w);break;case"dragend":E()}}),e.easemobIM=function(t){if(EasemobWidget.utils.isMobile){var s=document.getElementById(o),n=e.event.srcElement||e.event.target;t?(n.setAttribute("href",s.getAttribute("src")+"&emgroup="+escape(t)),n.setAttribute("target","_blank")):(n.setAttribute("href",s.getAttribute("src")),n.setAttribute("target","_blank"))}else if(t){var a=Emc.getcookie(t);i.sendToIframe("emgroup@"+a+"@emgroupuser@"+escape(t))}else i.sendToIframe("imclick")}},g=function(){if(s=/MSIE (6|7|8)/.test(navigator.userAgent)?document.createElement('<iframe name="'+(new Date).getTime()+'">'):document.createElement("iframe"),o="EasemobIframe"+(new Date).getTime(),s.id=o,s.name=(new Date).getTime(),s.frameBorder=0,s.allowTransparency="true",s.style.cssText="            z-index:16777269;            overflow:hidden;            position:fixed;            bottom:10px;            right:-5px;            border:none;            width:400px;            height:0;            display:none;            transition:all .01s;",m.style.cssText="            display:none;            cursor:move;            z-index:16777270;            position:fixed;            bottom:10px;            right:10px;            border:none;            width:400px;            height:500px;            border-radius:4px;            box-shadow: 0 4px 8px rgba(0,0,0,.2);            border-radius: 4px;",m.style.background="url("+h.domain+"webim/static/img/drag.png) no-repeat",l="initdata:"+h.domain+"webim/im.html?tenantId="+h.json.tenantId+(h.json.hide?"&hide=true":"")+(h.json.color?"&color="+h.json.color:"")+(h.json.preview?"&preview="+h.json.preview:"")+(n?"&c="+n:"")+(a?"&u="+a:"")+"&time="+(new Date).getTime(),s.src=h.domain+"webim/im.html?tenantId="+h.json.tenantId,h.json.hide?(s.style.height="12px",s.style.width="12px"):(s.style.height="37px",s.style.width="104px"),EasemobWidget.utils.isMobile&&(s.style.cssText+="left:0;bottom:0",s.style.width="100%"),h.json&&h.json.preview){var e=document.getElementById(h.json.previewid);e?e.appendChild(s):document.body.appendChild(s)}else document.body.appendChild(m),document.body.appendChild(s);s.readyState?s.onreadystatechange=function(){("loaded"===s.readyState||"complete"===s.readyState)&&(this.style.display="block",i=new EmMessage(o),f(),i.sendToIframe(l))}:s.onload=function(){this.style.display="block",i=new EmMessage(o),f(),i.sendToIframe(l)}},b=document.createElement("script");b.src=h.domain+"webim/static/js/easemob.utils.js",(document.head||document.getElementsByTagName("head")[0]).appendChild(b),b.readyState?b.onreadystatechange=function(){("loaded"==b.readyState||"complete"==b.readyState)&&x()}:b.onload=function(){x()};var x=function(){a=Emc.getcookie("emKefuUser"),n=Emc.getcookie("emKefuChannel"),g(),EasemobWidget.utils.on(m,"mouseup",E),k()},v=0,w=function(t){var i=(e.event||t,document.documentElement.clientWidth),s=document.documentElement.clientHeight,o=i-t.clientX-400+c.x,n=s-t.clientY-500+c.y;t.clientX-c.x<=0?o=i-400:t.clientX+400-c.x>=i&&(o=0),t.clientY-c.y<=0?n=s-500:t.clientY+500-c.y>=s&&(n=0),m.style.left="auto",m.style.top="auto",m.style.right=o+"px",m.style.bottom=n+"px",d={x:o,y:n},clearTimeout(v),v=setTimeout(E,500)},E=function(){EasemobWidget.utils.remove(document,"mousemove",w),s.style.left="auto",s.style.top="auto",s.style.right=d.x+"px",s.style.bottom=d.y+"px",m.style.left="auto",m.style.top="auto",m.style.right=d.x+"px",m.style.bottom=d.y+"px",m.style.display="none",s.style.display="block",i.sendToIframe("dragend")},k=function(){EasemobWidget.utils.on(e,"resize",function(){var e=document.documentElement.clientWidth,t=document.documentElement.clientHeight,i=Number(s.style.right.slice(0,-2)),o=Number(s.style.bottom.slice(0,-2));400>e?(s.style.left="auto",s.style.right=0,m.style.left="auto",m.style.right=0):400>e-i?(s.style.right=e-400+"px",s.style.left=0,m.style.right=e-400+"px",m.style.left=0):(s.style.left="auto",m.style.left="auto"),500>t?(s.style.top="auto",s.style.bottom=0):500>t-o?(s.style.bottom=t-500+"px",s.style.top=0):s.style.top="auto"})},j=function(t,i,s){t=t||"",i=i||"",s=s||"";try{if(e.Notification)if("granted"===Notification.permission){var o=new Notification(i,{icon:t,body:s});setTimeout(function(){o.close()},3e3)}else Notification.requestPermission()}catch(n){}}}(window,void 0);